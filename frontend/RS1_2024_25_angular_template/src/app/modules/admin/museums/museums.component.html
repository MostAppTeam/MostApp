<div id="museum-container">
  <!-- Heading + opis -->
  <h3>Explore Museums in Mostar</h3>
  <p class="description-text">
    Discover the rich history and culture at museums in Mostar. Learn more about their exhibits,
    locations, and working hours.
  </p>

  <div class="sorting-container">
    <div class="sorting-item">
      <label for="sort-by">Sort by:</label>
      <select id="sort-by" [(ngModel)]="sortBy">
        <option value="name">Name</option>
        <option value="location">Location</option>
        <option value="description">Description</option>
      </select>
    </div>

    <div class="sorting-item">
      <label for="sort-direction">Direction:</label>
      <select id="sort-direction" [(ngModel)]="sortDirection">
        <option value="asc">Ascending</option>
        <option value="desc">Descending</option>
      </select>
    </div>

    <div class="sorting-item">
      <button (click)="updateSort()">Sort</button>
    </div>

    <div class="sorting-item">
      <button class="btn-download" (click)="downloadAllMuseumsPdf()">
        Download ALL as PDF
      </button>
    </div>
  </div>

  <div *ngIf="museums.length > 0; else noMuseumsMessage" class="museum-cards">
    <div class="museum-card" *ngFor="let museum of museums">
      <h4>{{ museum.name }}</h4>
      <!-- Image (CLICK TO OPEN ZOOM VIEWER) -->
      <div
        *ngIf="museum.imageUrl"
        class="img-wrap"
        (click)="openViewer(getMuseumImageUrl(museum))"
      >
        <img
          [src]="getMuseumImageUrl(museum)"
          alt="{{ museum.name }}"
          width="250"
          class="zoomable"
        />

      </div>
      <!-- LIGHTBOX VIEWER -->
      <div
        class="image-viewer-overlay"
        *ngIf="viewerOpen"
        (wheel)="onWheelZoom($event)"
        (mousedown)="onMouseDown($event)"
        (mousemove)="onMouseMove($event)"
        (mouseup)="onMouseUp()">

        <div class="image-viewer-content">
          <img
            [src]="viewerImageUrl"
            [ngStyle]="getZoomStyle()"
            alt="Zoomed museum image"
          />
          <button class="close-btn" (click)="closeViewer()">âœ•</button>
          <button class="reset-btn" (click)="resetView()">Reset</button>
        </div>
      </div>


      <p>{{ museum.description }}</p>
      <p><strong>Location:</strong> {{ museum.location }}</p>
      <p><strong>Working Hours:</strong> {{ museum.workingHours }}</p>

      <button class="btn-download" (click)="downloadMuseumPdf(museum)">
        Download PDF
      </button>
    </div>
  </div>

  <ng-template #noMuseumsMessage>
    <p>No museums available.</p>
  </ng-template>

  <form *ngIf="isAdmin || isManager" (ngSubmit)="addMuseum()" id="add-museum-form">
    <h3>Add a Museum</h3>
    <input [(ngModel)]="newMuseum.name" placeholder="Name" name="name" required />
    <input [(ngModel)]="newMuseum.description" placeholder="Description" name="description" required />
    <input [(ngModel)]="newMuseum.location" placeholder="Location" name="location" required />
    <input [(ngModel)]="newMuseum.workingHours" placeholder="Working Hours" name="workingHours" required />
    <input [(ngModel)]="newMuseum.imageUrl" placeholder="Image URL" name="imageUrl" required />
    <input type="file" (change)="onFileSelected($event)" />

    <button type="submit">Add Museum</button>
  </form>

  <div *ngIf="feedbackMessage" id="feedback-message">
    {{ feedbackMessage }}
  </div>
</div>
